"use strict";(self.webpackChunkfaceit=self.webpackChunkfaceit||[]).push([[444],{2444:(E,h,l)=>{l.r(h),l.d(h,{vega_image_uploader:()=>g});var m=l(5861),a=l(5934),u=l(5986),p=l(3068),f=l(1951),_=l(7352),C=l(8768);l(7983),l(2723);const P=["jpg","png","jpeg"],g=class{constructor(n){(0,a.r)(this,n),this.vegaChange=(0,a.c)(this,"vegaChange",7),this.vegaRemove=(0,a.c)(this,"vegaRemove",7),this.vegaCancel=(0,a.c)(this,"vegaCancel",7),this.vegaValidate=(0,a.c)(this,"vegaValidate",7),this.value=null,this.accept=P.map(e=>`.${e}`).join(","),this.showPreviewButton=!0,this.showRemoveButton=!0,this.disabled=!1,this.required=!1,this.isValid=null,this.autoValidation=!0,this.validationRules=[],this.getImagePreviewURL=()=>{if(this.value)return this.value.url||URL.createObjectURL(this.value)},this.handleUploaderClick=e=>{e.stopPropagation(),!this.disabled&&this.fileInputRef.click()},this.handleFileInputChange=e=>{const t=e.target;t.files.length&&(this.value=t.files[0])},this.renderPreviewImage=e=>(0,a.h)("div",{class:"image-preview-container"},(0,a.h)("img",{src:e,alt:""}),(0,a.h)("span",{class:"actions"},this.showRemoveButton&&(0,a.h)("vega-button-circle",{icon:"delete-bin",danger:!0,size:"small",onClick:this.handleRemoveBtnClick}),this.showPreviewButton&&(0,a.h)("vega-button-circle",{icon:"zoom-in",size:"small",onClick:this.handlePreviewBtnClick}))),this.handleRemoveBtnClick=e=>{e.stopPropagation(),this.showRemoveConfirmModal({type:"danger",title:"Delete Image",content:"Are you sure you want to delete this image?",onOk:()=>{this.handleRemove()}})},this.handleRemove=()=>{this.value=null,this.fileInputRef.value="",this.vegaRemove.emit()},this.handlePreviewBtnClick=e=>{e.stopPropagation();const t=this.getImagePreviewURL();this.previewModalRef?(this.previewModalRef.querySelector(".preview-image").src=t,this.previewModalRef.modalTitle=this.value.name,this.previewModalRef.modal("show")):this.generatePreviewModal(t).modal("show")},this.generatePreviewModal=e=>{const t=document.createElement("vega-modal");return t.modalTitle=this.value.name,t.innerHTML=`\n        <div class="v-text-center">\n          <img class="v-w-full preview-image" src="${e}" alt="" />\n        </div>\n      `,this.previewModalRef=t,document.body.append(t),t},this.renderContentByStatus=()=>{if("uploading"===this.status)return this.renderUploading();{const e=this.getImagePreviewURL();return e?this.renderPreviewImage(e):this.renderUploaderContent()}},this.renderUploading=()=>(0,a.h)("div",{class:"action-wrapper",role:"button",tabIndex:0,onClick:this.handleCancelUploading,onKeyDown:(0,u.c)()},(0,a.h)("span",{class:"action-loading"}),(0,a.h)("div",{class:"vega-image-uploader-text cancel-action"},"Cancel")),this.renderUploaderContent=()=>(0,a.h)("div",{class:"action-wrapper",role:"button",tabIndex:0,onClick:this.handleUploaderClick,onKeyDown:(0,u.c)()},(0,a.h)("vega-icon",{icon:"plus-sign",size:"size-24"}),(0,a.h)("div",{class:"vega-image-uploader-text"},"Upload")),this.handleCancelUploading=e=>{e.stopPropagation(),this.status=void 0,this.handleRemove(),this.vegaCancel.emit()},this.showRemoveConfirmModal=e=>{var t,o;const d=(null===(t=e.okBtnProps)||void 0===t?void 0:t.text)||"Delete",s=(null===(o=e.cancelBtnProps)||void 0===o?void 0:o.text)||"Cancel",i=document.createElement("vega-modal");i.id=`vega-modal-confirm-${(0,f.g)()}`,i.modalTitle=e.title,i.size=e.size||440,i.backdrop="static",i.innerHTML=`\n    <div slot="modal-content" class="v-font-p2-long v-text-primary">\n    ${e.content}\n    </div>\n    <div slot="modal-footer">\n        <vega-flex gap="size-12" justify-content="end">\n          <vega-button variant="secondary" danger="true" size="small">${s}</vega-button>\n          <vega-button danger="true" size="small">${d}</vega-button>\n        </vega-flex>\n    </div>\n    `;const v=i.querySelector("vega-button:nth-child(2)"),w=i.querySelector("vega-button:nth-child(1)");v.addEventListener("click",c=>{var r;c.stopPropagation(),null===(r=e.onOk)||void 0===r||r.call(e),i.modal("hide"),i.remove()}),w.addEventListener("click",c=>{var r;c.stopPropagation(),null===(r=e.onCancel)||void 0===r||r.call(e),i.modal("hide"),i.remove()}),document.body.append(i),i.modal("show")}}watchValue(){this.vegaChange.emit(this.value)}watchIsValid(n){this.vegaValidate.emit(n)}disconnectedCallback(){var n;null===(n=this.previewModalRef)||void 0===n||n.remove()}valid(n=!0){var e=this;return(0,m.Z)(function*(){var t;return null===(t=e.validator)||void 0===t?void 0:t.validate(n)})()}render(){return(0,p.s)((0,a.h)(a.H,{class:{disabled:this.disabled}},(0,a.h)("div",{class:"vega-image-uploader-select"},this.renderContentByStatus()),(0,a.h)("input",{type:"file",accept:this.accept,class:"v-hidden",ref:n=>this.fileInputRef=n,onChange:this.handleFileInputChange})),this.host)}get host(){return(0,a.g)(this)}static get watchers(){return{value:["watchValue"],isValid:["watchIsValid"]}}};!function(n,e,t,o){var i,d=arguments.length,s=d<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,t):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,e,t,o);else for(var v=n.length-1;v>=0;v--)(i=n[v])&&(s=(d<3?i(s):d>3?i(e,t,s):i(e,t))||s);d>3&&s&&Object.defineProperty(e,t,s)}([(0,C.I)({entries:[{propertyName:"required",ruleFactory:n=>n?new _.R:null}]},{name:"validationRules"},".vega-image-uploader-select","input",!0)],g.prototype,"validator",void 0)}}]);